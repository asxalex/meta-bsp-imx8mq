From 717569c1e58faac836340569a311ba0a3e09eaef Mon Sep 17 00:00:00 2001
From: Valentin Raevsky <valentin@compulab.co.il>
Date: Wed, 29 Apr 2020 20:43:52 +0300
Subject: [PATCH 35/42] cl-som-imx8: mach: Remove unused stuff

Signed-off-by: Valentin Raevsky <valentin@compulab.co.il>
---
 arch/arm64/mach-imx/mach-cl_som_imx8.c | 34 +++-------------------------------
 1 file changed, 3 insertions(+), 31 deletions(-)

diff --git a/arch/arm64/mach-imx/mach-cl_som_imx8.c b/arch/arm64/mach-imx/mach-cl_som_imx8.c
index 655547b..06e36d9 100644
--- a/arch/arm64/mach-imx/mach-cl_som_imx8.c
+++ b/arch/arm64/mach-imx/mach-cl_som_imx8.c
@@ -1,45 +1,17 @@
-#include <linux/reboot.h>
 #include <linux/module.h>
-#include <linux/gpio.h>
 #include <linux/of.h>
 #include <linux/of_platform.h>
-#include <linux/mfd/syscon.h>
-#include <linux/mfd/syscon/imx8mq-iomuxc-gpr.h>
 #include <linux/regmap.h>
 
-extern void (*arm_pm_restart)(enum reboot_mode reboot_mode, const char *cmd);
-
-void board_pm_restart(enum reboot_mode reboot_mode, const char *cmd)
-{
-	gpio_request(79, "board-reset");
-	gpio_direction_output(79, 0);
-}
-
-static void gpr_init(void)
-{
-	struct regmap *gpr;
-
-	gpr = syscon_regmap_lookup_by_compatible("fsl,imx8mq-iomuxc-gpr");
-	if (!IS_ERR(gpr)) {
-		pr_info("IOMUXC_GPR5[0] = 1\n");
-		regmap_update_bits(gpr, IOMUXC_GPR5, 1 << 0, 1 << 0);
-	} else {
-		pr_err("%s(): failed to find fsl,imx6q-iomuxc-gpr regmap\n",
-		       __func__);
-	}
-}
-
 static int cl_som_imx8_init(void)
 {
 	struct device_node *np =
-		of_find_compatible_node(NULL, NULL, "compulab,cl-som-imx8,rev1.0");
+		of_find_compatible_node(NULL, NULL, "compulab,cl-som-imx8");
 
 	if (!np)
 		return 0;
 
-	arm_pm_restart = board_pm_restart;
-	gpr_init();
-
+	/* Board init code here */
 	return 0;
 }
 
@@ -51,6 +23,6 @@ static void __exit cl_som_imx8_exit(void)
 module_exit(cl_som_imx8_exit);
 
 MODULE_AUTHOR("CompuLab, Ltd.");
-MODULE_DESCRIPTION("CompuLab CL-SOMiMX8 machine driver");
+MODULE_DESCRIPTION("CompuLab CL-SOM-iMX8 machine driver");
 MODULE_LICENSE("GPL v2");
 MODULE_ALIAS("platform:cl-som-imx8");
-- 
1.9.1

